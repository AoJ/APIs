/* 
# Webshell APIs
# Copyright (C) 2013 Webshell SAS
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program. If not, see <http://www.gnu.org/licenses/>.
 */

({
	auth:function(){return auth({provider:'boxcar'})},
	'subscribeToProvider': function(args, opts) {
		var url = 'https://boxcar.io/devices/providers/{provider_key}/notifications/subscribe'
		args = args || {}
		if (args['provider_key'] == null) throw new Error('provider_key is a required parameter')
		var rgx = new RegExp('\{provider_key\}', 'g')
		if (url.match(rgx)) {
			url = url.replace(rgx, args['provider_key'])
			if (args['provider_key']) delete args['provider_key']
		}
		if (url.indexOf('[/provider_key]') !== -1) {
			url = url.replace('[/provider_key]', '/' + args['provider_key'])
			if (args['provider_key']) delete args['provider_key']
		}
		if (args['email'] == null) throw new Error('email is a required parameter')
		var rgx = new RegExp('\{email\}', 'g')
		if (url.match(rgx)) {
			url = url.replace(rgx, args['email'])
			if (args['email']) delete args['email']
		}
		if (url.indexOf('[/email]') !== -1) {
			url = url.replace('[/email]', '/' + args['email'])
			if (args['email']) delete args['email']
		}
		if (url.indexOf('[/provider_key]') !== -1) url = url.replace('[/provider_key]', '')
		if (url.indexOf('[/email]') !== -1) url = url.replace('[/email]', '')
		return http({provider:'boxcar',url:url,method:'POST',params:args, auth:'none'}, opts)
	}
})